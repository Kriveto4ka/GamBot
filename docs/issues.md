# Issues

## [ISSUE-008] "–°–º–µ—Ä—Ç–µ–ª—å–Ω–∞—è –ø–µ—Ç–ª—è" –ø—Ä–∏ –ø—Ä–æ–≤–µ—Ä–∫–µ –¥–µ–¥–ª–∞–π–Ω–æ–≤ (Death Loop)
–í `check_deadlines` –ø–æ—Å–ª–µ —Å–º–µ—Ä—Ç–∏ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞ —Ü–∏–∫–ª –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç—Å—è, –∏ –æ—Å—Ç–∞–≤—à–∏–µ—Å—è –∑–∞–¥–∞—á–∏ –Ω–∞–Ω–æ—Å—è—Ç —É—Ä–æ–Ω –≤–æ—Å–∫—Ä–µ—Å—à–µ–º—É –ø–µ—Ä—Å–æ–Ω–∞–∂—É.
**–†–µ—à–µ–Ω–∏–µ:** –ü—Ä–µ—Ä—ã–≤–∞—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É –∏–ª–∏ —É–¥–∞–ª—è—Ç—å –∑–∞–¥–∞—á–∏ –ø—Ä–∏ —Å–º–µ—Ä—Ç–∏.

## [ISSUE-009] –ù–µ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –∫–∞—Å–∫–∞–¥–Ω–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ –∑–∞–¥–∞—á –ø—Ä–∏ —Å–º–µ—Ä—Ç–∏
–ö–∞—Å–∫–∞–¥ `ON DELETE CASCADE` –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç, —Ç–∞–∫ –∫–∞–∫ `reset_character` –Ω–µ —É–¥–∞–ª—è–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –∞ —Ç–æ–ª—å–∫–æ –æ–±–Ω–æ–≤–ª—è–µ—Ç –ø–æ–ª—è. –ó–∞–¥–∞—á–∏ –æ—Å—Ç–∞—é—Ç—Å—è.
**–†–µ—à–µ–Ω–∏–µ:** –Ø–≤–Ω–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ –∑–∞–¥–∞—á –≤ `reset_character`.

---

## [AP-007] –£—Å—Ç–∞—Ä–µ–≤—à–∏–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –≤ –∫–æ–¥–µ

**–û–ø–∏—Å–∞–Ω–∏–µ:** –í `database/task_repo.py` –¥–ª—è —Ñ—É–Ω–∫—Ü–∏–∏ `complete_task` —Å–æ—Ö—Ä–∞–Ω–µ–Ω –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π `Phase 2: no XP`.

**–°—Ç–∞—Ç—É—Å:** –ó–∞–∫—Ä—ã—Ç–æ.

**–†–µ—à–µ–Ω–∏–µ:** –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –æ–±–Ω–æ–≤–ª–µ–Ω: "XP/Level-up is handled in the handler". –§–∞–π–ª: `database/task_repo.py`.

---

## [AP-008] –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Emoji –≤ –∫–æ–Ω—Å–æ–ª—å–Ω–æ–º –≤—ã–≤–æ–¥–µ —Ç–µ—Å—Ç–æ–≤ –±–µ–∑ —è–≤–Ω–æ–π –∫–æ–¥–∏—Ä–æ–≤–∫–∏

**–û–ø–∏—Å–∞–Ω–∏–µ:** –°–∫—Ä–∏–ø—Ç—ã –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç —Å–∏–º–≤–æ–ª—ã Emoji, —á—Ç–æ –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ `UnicodeEncodeError` –Ω–∞ Windows.

**–°—Ç–∞—Ç—É—Å:** –ó–∞–∫—Ä—ã—Ç–æ.

**–†–µ—à–µ–Ω–∏–µ:** –í –Ω–∞—á–∞–ª–æ —Å–∫—Ä–∏–ø—Ç–æ–≤ –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ `sys.stdout.reconfigure(encoding='utf-8')`. –§–∞–π–ª—ã: `tests/verify_phase5.py`.

---

## [ISSUE-001] –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ username –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ –ë–î

**–°—Ç–∞—Ç—É—Å:** –ó–∞–∫—Ä—ã—Ç–æ

**–û–ø–∏—Å–∞–Ω–∏–µ:** –í `database/user_repo.py` –ø—Ä–∏ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ –ø–æ–ª–µ `username` –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –≤ –æ–±—ä–µ–∫—Ç–µ (`user.username = username`), –Ω–æ —Å–µ—Å—Å–∏—è –Ω–µ –∫–æ–º–º–∏—Ç–∏—Ç—Å—è. –ü–æ—Å–ª–µ –≤—ã—Ö–æ–¥–∞ –∏–∑ `get_or_create_user` –∏–∑–º–µ–Ω–µ–Ω–∏—è –Ω–µ –ø–æ–ø–∞–¥–∞—é—Ç –≤ PostgreSQL ‚Äî –ø—Ä–∏ —Å–ª–µ–¥—É—é—â–∏—Ö –∑–∞–ø—É—Å–∫–∞—Ö —É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø–æ-–ø—Ä–µ–∂–Ω–µ–º—É —Å—Ç–∞—Ä—ã–π –∏–ª–∏ –ø—É—Å—Ç–æ–π username.

**–ü—Ä–∏—á–∏–Ω–∞:** –í—ã–∑—ã–≤–∞—é—â–∏–π –∫–æ–¥ (handlers) –Ω–µ –≤—ã–∑—ã–≤–∞–ª `commit()` –ø–æ—Å–ª–µ `get_or_create_user`, –ø–æ—ç—Ç–æ–º—É –∏–∑–º–µ–Ω–µ–Ω–∏—è –Ω–µ –ø–æ–ø–∞–¥–∞–ª–∏ –≤ PostgreSQL.

**–†–µ—à–µ–Ω–∏–µ:** –í `get_or_create_user` –ø–æ—Å–ª–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è `username` —É —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤—ã–∑—ã–≤–∞—Ç—å `await session.commit()`. –†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π —Å–∞–º —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–µ; –≤—ã–∑—ã–≤–∞—é—â–µ–º—É –∫–æ–¥—É –Ω–µ –Ω—É–∂–Ω–æ –∑–Ω–∞—Ç—å –æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –∫–æ–º–º–∏—Ç–∞. –§–∞–π–ª: `database/user_repo.py`.

---

## [ISSUE-002] –¢–µ—Å—Ç –Ω–∞—á–∞–ª—å–Ω—ã—Ö —Å—Ç–∞—Ç–æ–≤ –Ω–µ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –º–æ–¥–µ–ª—å/–ë–î

**–°—Ç–∞—Ç—É—Å:** –ó–∞–∫—Ä—ã—Ç–æ

**–û–ø–∏—Å–∞–Ω–∏–µ:** –í `tests/test_character.py` —Ç–µ—Å—Ç `test_initial_character_stats` –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Ç–æ–ª—å–∫–æ –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã `level=1, xp=0, hp=100, max_hp=100` –∏ –Ω–µ —Å–æ–∑–¥–∞—ë—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —á–µ—Ä–µ–∑ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –∏ –Ω–µ —Å—Ä–∞–≤–Ω–∏–≤–∞–µ—Ç —Å –ø–æ–ª—è–º–∏ –º–æ–¥–µ–ª–∏ User. –†–µ–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ç–æ–≥–æ, —á—Ç–æ –Ω–æ–≤—ã–π –ø–µ—Ä—Å–æ–Ω–∞–∂ –≤ –ë–î —Å–æ–∑–¥–∞—ë—Ç—Å—è —Å —ç—Ç–∏–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏ (SPEC 2.1), –Ω–µ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è ‚Äî —Ä–µ–≥—Ä–µ—Å—Å–∏—è –≤ `user_repo` –∏–ª–∏ –º–æ–¥–µ–ª–∏ –º–æ–∂–µ—Ç –æ—Å—Ç–∞—Ç—å—Å—è –Ω–µ–∑–∞–º–µ—á–µ–Ω–Ω–æ–π.

**–ü—Ä–∏—á–∏–Ω–∞:** –¢–µ—Å—Ç –Ω–µ –±—ã–ª –ø—Ä–∏–≤—è–∑–∞–Ω –∫ –º–æ–¥–µ–ª–∏ `User` –∏ –∫–æ–Ω—Å—Ç–∞–Ω—Ç–∞–º –∏–∑ `config`; —Ä–µ–≥—Ä–µ—Å—Å–∏—è –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ –∏–ª–∏ –≤ –∑–Ω–∞—á–µ–Ω–∏—è—Ö –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –º–æ–≥–ª–∞ –æ—Å—Ç–∞—Ç—å—Å—è –Ω–µ–∑–∞–º–µ—á–µ–Ω–Ω–æ–π.

**–†–µ—à–µ–Ω–∏–µ:** –¢–µ—Å—Ç —Å–æ–∑–¥–∞—ë—Ç —ç–∫–∑–µ–º–ø–ª—è—Ä `User` —Å —Ç–µ–º–∏ –∂–µ –∞—Ä–≥—É–º–µ–Ω—Ç–∞–º–∏, —á—Ç–æ –∏ `get_or_create_user` (–∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã `DEFAULT_LEVEL`, `DEFAULT_XP`, `DEFAULT_HP`, `DEFAULT_MAX_HP` –∏–∑ config), –∏ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –ø–æ–ª—è –º–æ–¥–µ–ª–∏. –¢–∞–∫ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ SPEC 2.1 –∏ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç—å –∫–æ–Ω—Ñ–∏–≥–∞ —Å –º–æ–¥–µ–ª—å—é. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π —Ç–µ—Å—Ç —Å –ë–î (–≤—ã–∑–æ–≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è) –æ—Å—Ç–∞–≤–ª–µ–Ω –Ω–∞ –±—É–¥—É—â–µ–µ. –§–∞–π–ª: `tests/test_character.py`.

---

## [ISSUE-003] –ü–æ–≤—Ç–æ—Ä–Ω–æ–µ –Ω–∞–∂–∞—Ç–∏–µ —Ç–æ–π –∂–µ –∫–Ω–æ–ø–∫–∏ –º–æ–∂–µ—Ç –≤—ã–∑–≤–∞—Ç—å –æ—à–∏–±–∫—É Telegram API

**–°—Ç–∞—Ç—É—Å:** –ó–∞–∫—Ä—ã—Ç–æ

**–û–ø–∏—Å–∞–Ω–∏–µ:** –í `bot/handlers/menu.py` –ø—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ ¬´–ú–µ–Ω—é¬ª –∏–ª–∏ ¬´–ü–µ—Ä—Å–æ–Ω–∞–∂¬ª –≤—Å–µ–≥–¥–∞ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è `callback.message.edit_text(...)`. –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É–∂–µ –Ω–∞ —ç–∫—Ä–∞–Ω–µ –≥–ª–∞–≤–Ω–æ–≥–æ –º–µ–Ω—é –∏ —Å–Ω–æ–≤–∞ –Ω–∞–∂–∏–º–∞–µ—Ç ¬´–ú–µ–Ω—é¬ª (–∏–ª–∏ —É–∂–µ –Ω–∞ —ç–∫—Ä–∞–Ω–µ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞ –∏ –Ω–∞–∂–∏–º–∞–µ—Ç ¬´–ü–µ—Ä—Å–æ–Ω–∞–∂¬ª), —Ç–µ–∫—Å—Ç –∏ –∫–ª–∞–≤–∏–∞—Ç—É—Ä–∞ –Ω–µ –º–µ–Ω—è—é—Ç—Å—è. Telegram API –≤ —Ç–∞–∫–∏—Ö —Å–ª—É—á–∞—è—Ö –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ—à–∏–±–∫—É ¬´Message is not modified¬ª ‚Äî –±–æ—Ç –º–æ–∂–µ—Ç –ª–æ–≥–∏—Ä–æ–≤–∞—Ç—å –∏—Å–∫–ª—é—á–µ–Ω–∏–µ –∏–ª–∏ –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å –æ—à–∏–±–∫—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é.

**–ü—Ä–∏—á–∏–Ω–∞:** –ü—Ä–∏ –ø–æ–≤—Ç–æ—Ä–Ω–æ–º –Ω–∞–∂–∞—Ç–∏–∏ —Ç–æ–π –∂–µ –∫–Ω–æ–ø–∫–∏ —Ç–µ–∫—Å—Ç –∏ –∫–ª–∞–≤–∏–∞—Ç—É—Ä–∞ –Ω–µ –º–µ–Ω—è—é—Ç—Å—è, –∏ Telegram API –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ—à–∏–±–∫—É ¬´message is not modified¬ª.

**–†–µ—à–µ–Ω–∏–µ:** –í–≤–µ–¥–µ–Ω–∞ –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è `_safe_edit_text(message, text, reply_markup)`: –≤—ã–∑–æ–≤ `message.edit_text(...)` –∏ –ø–µ—Ä–µ—Ö–≤–∞—Ç `TelegramBadRequest`; –µ—Å–ª–∏ –≤ —Ç–µ–∫—Å—Ç–µ –æ—à–∏–±–∫–∏ –µ—Å—Ç—å ¬´message is not modified¬ª, –∏—Å–∫–ª—é—á–µ–Ω–∏–µ –∏–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç—Å—è, –∏–Ω–∞—á–µ –ø—Ä–æ–±—Ä–∞—Å—ã–≤–∞–µ—Ç—Å—è. –í—Å–µ –≤—ã–∑–æ–≤—ã `edit_text` –≤ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞—Ö –º–µ–Ω—é –∑–∞–º–µ–Ω–µ–Ω—ã –Ω–∞ `_safe_edit_text`. –§–∞–π–ª: `bot/handlers/menu.py`.

---

## [ISSUE-004] –ü–∞–¥–µ–Ω–∏–µ –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ –º–µ–Ω—é/–ø–µ—Ä—Å–æ–Ω–∞–∂–∞ –ø—Ä–∏ –Ω–∞–ª–∏—á–∏–∏ –∞–∫—Ç–∏–≤–Ω—ã—Ö –∑–∞–¥–∞—á (get_nearest_deadline)

**–°—Ç–∞—Ç—É—Å:** –ó–∞–∫—Ä—ã—Ç–æ

**–û–ø–∏—Å–∞–Ω–∏–µ:** –í `database/task_repo.py` —Ñ—É–Ω–∫—Ü–∏—è `get_nearest_deadline` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç `row[0] if row else None`, –≥–¥–µ `row = result.scalar_one_or_none()`. –î–ª—è –∑–∞–ø—Ä–æ—Å–∞ `select(Task.deadline)` –º–µ—Ç–æ–¥ `scalar_one_or_none()` –≤ SQLAlchemy 2.0 –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–∫–∞–ª—è—Ä (–∑–Ω–∞—á–µ–Ω–∏–µ `datetime`), –∞ –Ω–µ —Å—Ç—Ä–æ–∫—É Row. –û–±—Ä–∞—â–µ–Ω–∏–µ `row[0]` –∫ –æ–±—ä–µ–∫—Ç—É `datetime` –≤—ã–∑—ã–≤–∞–µ—Ç `TypeError`. –û—à–∏–±–∫–∞ –ø—Ä–æ—è–≤–ª—è–µ—Ç—Å—è –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ –≥–ª–∞–≤–Ω–æ–≥–æ –º–µ–Ω—é –∏–ª–∏ —ç–∫—Ä–∞–Ω–∞ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞, –µ—Å–ª–∏ —É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –µ—Å—Ç—å —Ö–æ—Ç—è –±—ã –æ–¥–Ω–∞ –∞–∫—Ç–∏–≤–Ω–∞—è –∑–∞–¥–∞—á–∞.

**–ü—Ä–∏—á–∏–Ω–∞:** –î–ª—è –∑–∞–ø—Ä–æ—Å–∞ —Å –æ–¥–Ω–æ–π –∫–æ–ª–æ–Ω–∫–æ–π `scalar_one_or_none()` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–∫–∞–ª—è—Ä, –∞ –Ω–µ Row; –æ–±—Ä–∞—â–µ–Ω–∏–µ `row[0]` –∫ —Å–∫–∞–ª—è—Ä—É –¥–∞—ë—Ç TypeError.

**–†–µ—à–µ–Ω–∏–µ:** –í–æ–∑–≤—Ä–∞—â–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç –Ω–∞–ø—Ä—è–º—É—é: `return result.scalar_one_or_none()`. –§–∞–π–ª: `database/task_repo.py`.

---

## [ISSUE-005] –î–µ—Ç–∞–ª—å –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω–æ–π –∑–∞–¥–∞—á–∏: –∫–Ω–æ–ø–∫–∞ ¬´–í—ã–ø–æ–ª–Ω–µ–Ω–æ¬ª –≤–µ–¥—ë—Ç –∫ ¬´–ó–∞–¥–∞—á–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞¬ª

**–°—Ç–∞—Ç—É—Å:** –ó–∞–∫—Ä—ã—Ç–æ

**–û–ø–∏—Å–∞–Ω–∏–µ:** `get_task_by_id` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∑–∞–¥–∞—á—É —Å –ª—é–±—ã–º —Å—Ç–∞—Ç—É—Å–æ–º, –∫—Ä–æ–º–µ `deleted`. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç –æ—Ç–∫—Ä—ã—Ç—å –¥–µ—Ç–∞–ª–∏ —É–∂–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω–æ–π –∑–∞–¥–∞—á–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ø–æ —Å—Ç–∞—Ä–æ–π –∫–Ω–æ–ø–∫–µ –≤ —Å–ø–∏—Å–∫–µ –∏–ª–∏ –∏–∑ –∫—ç—à–∞). –ù–∞ —ç–∫—Ä–∞–Ω–µ –¥–µ—Ç–∞–ª–∏ –ø–æ-–ø—Ä–µ–∂–Ω–µ–º—É –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –∫–Ω–æ–ø–∫–∏ ¬´–í—ã–ø–æ–ª–Ω–µ–Ω–æ¬ª –∏ ¬´–£–¥–∞–ª–∏—Ç—å¬ª. –ü—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ ¬´–í—ã–ø–æ–ª–Ω–µ–Ω–æ¬ª –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è `complete_task`, –∫–æ—Ç–æ—Ä—ã–π –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç `None` (–∑–∞–¥–∞—á–∞ –Ω–µ –≤ —Å—Ç–∞—Ç—É—Å–µ `active`), –∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è ¬´–ó–∞–¥–∞—á–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞ –∏–ª–∏ —É–∂–µ —É–¥–∞–ª–µ–Ω–∞¬ª –≤–º–µ—Å—Ç–æ —è–≤–Ω–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è –≤—Ä–æ–¥–µ ¬´–ó–∞–¥–∞—á–∞ —É–∂–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∞¬ª.

**–ü—Ä–∏—á–∏–Ω–∞:** –ö–ª–∞–≤–∏–∞—Ç—É—Ä–∞ –¥–µ—Ç–∞–ª–∏ –Ω–µ —É—á–∏—Ç—ã–≤–∞–ª–∞ —Å—Ç–∞—Ç—É—Å –∑–∞–¥–∞—á–∏; –ø—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ ¬´–í—ã–ø–æ–ª–Ω–µ–Ω–æ¬ª –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω–æ–π –∑–∞–¥–∞—á–∏ –ø–æ–∫–∞–∑—ã–≤–∞–ª–æ—Å—å –æ–±—â–µ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ.

**–†–µ—à–µ–Ω–∏–µ:** (1) `task_detail_keyboard` –ø—Ä–∏–Ω–∏–º–∞–µ—Ç `Task`: –∫–Ω–æ–ø–∫–∞ ¬´–í—ã–ø–æ–ª–Ω–µ–Ω–æ¬ª –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø—Ä–∏ `task.status == ACTIVE`; –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω–æ–π/–ø—Ä–æ—Å—Ä–æ—á–µ–Ω–Ω–æ–π ‚Äî —Ç–æ–ª—å–∫–æ ¬´–£–¥–∞–ª–∏—Ç—å¬ª –∏ ¬´–ö –∑–∞–¥–∞—á–∞–º¬ª. (2) –í –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–µ ¬´–í—ã–ø–æ–ª–Ω–µ–Ω–æ¬ª –ø—Ä–∏ `complete_task` ‚Üí None –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è, –µ—Å—Ç—å –ª–∏ –∑–∞–¥–∞—á–∞ —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º `completed`; –µ—Å–ª–∏ –¥–∞ ‚Äî –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è —Ç–µ–∫—Å—Ç ¬´–ó–∞–¥–∞—á–∞ —É–∂–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∞¬ª (—Ñ—É–Ω–∫—Ü–∏—è `task_already_completed()` –≤ `bot/texts.py`). –§–∞–π–ª—ã: `bot/keyboards.py`, `bot/handlers/task_list.py`, `bot/texts.py`.

---

## [ISSUE-006] –≠–∫—Ä–∞–Ω –ø–µ—Ä—Å–æ–Ω–∞–∂–∞: –ø–æ–¥–ø–∏—Å—å ¬´–ë–ª–∏–∂–∞–π—à–∏–π –¥–µ–¥–ª–∞–π–Ω¬ª –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –æ—Å—Ç–∞—Ç–æ–∫ –≤—Ä–µ–º–µ–Ω–∏, –∞ –Ω–µ –¥–∞—Ç—É

**–°—Ç–∞—Ç—É—Å:** –ó–∞–∫—Ä—ã—Ç–æ

**–û–ø–∏—Å–∞–Ω–∏–µ:** –í `bot/handlers/menu.py` –¥–ª—è —ç–∫—Ä–∞–Ω–∞ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞ –≤ –ø–æ–ª–µ ¬´–ë–ª–∏–∂–∞–π—à–∏–π –¥–µ–¥–ª–∞–π–Ω¬ª –ø–æ–¥—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç `format_remaining(nearest)` (–Ω–∞–ø—Ä–∏–º–µ—Ä, ¬´5—á 23–º–∏–Ω¬ª, ¬´–ø—Ä–æ—Å—Ä–æ—á–µ–Ω–æ¬ª). –¢–æ –µ—Å—Ç—å –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –æ—Å—Ç–∞—Ç–æ–∫ –≤—Ä–µ–º–µ–Ω–∏ –¥–æ –¥–µ–¥–ª–∞–π–Ω–∞, –∞ –Ω–µ —Å–∞–º–∞ –¥–∞—Ç–∞/–≤—Ä–µ–º—è –¥–µ–¥–ª–∞–π–Ω–∞. –ü–æ–¥–ø–∏—Å—å ¬´–ë–ª–∏–∂–∞–π—à–∏–π –¥–µ–¥–ª–∞–π–Ω¬ª –æ–±—ã—á–Ω–æ –ø–æ–¥—Ä–∞–∑—É–º–µ–≤–∞–µ—Ç –¥–∞—Ç—É –∏ –≤—Ä–µ–º—è; –≤–æ–∑–º–æ–∂–Ω–∞ –ø—É—Ç–∞–Ω–∏—Ü–∞ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

**–ü—Ä–∏—á–∏–Ω–∞:** –í `_get_user_and_tasks` –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∞—Å—å `format_remaining(nearest)` –≤–º–µ—Å—Ç–æ –¥–∞—Ç—ã/–≤—Ä–µ–º–µ–Ω–∏ –¥–µ–¥–ª–∞–π–Ω–∞.

**–†–µ—à–µ–Ω–∏–µ:** –ü–æ–¥—Å—Ç–∞–≤–ª—è—Ç—å –≤ ¬´–ë–ª–∏–∂–∞–π—à–∏–π –¥–µ–¥–ª–∞–π–Ω¬ª —Ä–µ–∑—É–ª—å—Ç–∞—Ç `format_deadline_date(nearest)` (–Ω–∞–ø—Ä–∏–º–µ—Ä, ¬´—Å–µ–≥–æ–¥–Ω—è, 18:00¬ª, ¬´25.01, 12:00¬ª) –≤–º–µ—Å—Ç–æ `format_remaining`. –§–∞–π–ª: `bot/handlers/menu.py`.

---

## [ISSUE-007] –ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π callback –≤—ã–±–æ—Ä–∞ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è —Ç–∏—Ö–∏–º –≤—ã—Ö–æ–¥–æ–º

**–°—Ç–∞—Ç—É—Å:** –ó–∞–∫—Ä—ã—Ç–æ

**–û–ø–∏—Å–∞–Ω–∏–µ:** –í `bot/handlers/task_create.py` –≤ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–µ `step_difficulty` –ø—Ä–∏ –Ω–µ—Å–æ–≤–ø–∞–¥–µ–Ω–∏–∏ `diff` —Å –¥–æ–ø—É—Å—Ç–∏–º—ã–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è `return` –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å–æ–æ–±—â–µ–Ω–∏—è –∏ –±–µ–∑ –æ—Ç–≤–µ—Ç–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Å—Ç–∞—ë—Ç—Å—è –Ω–∞ —à–∞–≥–µ –≤—ã–±–æ—Ä–∞ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏, –Ω–æ –Ω–µ –ø–æ–ª—É—á–∞–µ—Ç –Ω–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —ç–∫—Ä–∞–Ω–∞, –Ω–∏ —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–µ ‚Äî —Å–æ–∑–¥–∞—ë—Ç—Å—è –≤–ø–µ—á–∞—Ç–ª–µ–Ω–∏–µ, —á—Ç–æ –∫–Ω–æ–ø–∫–∞ –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–ª–∞.

**–ü—Ä–∏—á–∏–Ω–∞:** –ü—Ä–∏ –Ω–µ–≤–∞–ª–∏–¥–Ω–æ–º callback –≤—ã–∑—ã–≤–∞–ª—Å—è —Ç–æ–ª—å–∫–æ `return`, –±–µ–∑ `callback.answer()` —Å –ø–æ–¥—Å–∫–∞–∑–∫–æ–π.

**–†–µ—à–µ–Ω–∏–µ:** –ü–µ—Ä–µ–¥ –≤—ã—Ö–æ–¥–æ–º –ø—Ä–∏ –Ω–µ–≤–∞–ª–∏–¥–Ω–æ–º `diff` –≤—ã–∑—ã–≤–∞—Ç—å `await callback.answer("–í—ã–±–µ—Ä–∏ —Å–ª–æ–∂–Ω–æ—Å—Ç—å –∏–∑ –∫–Ω–æ–ø–æ–∫ –Ω–∏–∂–µ.", show_alert=True)`, –∑–∞—Ç–µ–º `return`. –û–±—ã—á–Ω—ã–π `callback.answer()` –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –≤–∞–ª–∏–¥–Ω–æ–º –≤—ã–±–æ—Ä–µ. –§–∞–π–ª: `bot/handlers/task_create.py`.

---

## [ISSUE-008] "–°–º–µ—Ä—Ç–µ–ª—å–Ω–∞—è –ø–µ—Ç–ª—è" –ø—Ä–∏ –ø—Ä–æ–≤–µ—Ä–∫–µ –¥–µ–¥–ª–∞–π–Ω–æ–≤ (Death Loop)

**–°—Ç–∞—Ç—É—Å:** –ó–∞–∫—Ä—ã—Ç–æ

**–û–ø–∏—Å–∞–Ω–∏–µ:** –í `bot/logic/tasks.py` —Ñ—É–Ω–∫—Ü–∏—è `check_deadlines` –ø–µ—Ä–µ–±–∏—Ä–∞–µ—Ç –ø—Ä–æ—Å—Ä–æ—á–µ–Ω–Ω—ã–µ –∑–∞–¥–∞—á–∏ –≤ —Ü–∏–∫–ª–µ. –ü—Ä–∏ –∫–∞–∂–¥–æ–π –∏—Ç–µ—Ä–∞—Ü–∏–∏ –Ω–∞–Ω–æ—Å–∏—Ç—Å—è —É—Ä–æ–Ω. –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É–º–∏—Ä–∞–µ—Ç (HP <= 0) –Ω–∞ –æ–¥–Ω–æ–π –∏–∑ –∑–∞–¥–∞—á, –º–µ—Ç–æ–¥ `apply_damage` —Å–±—Ä–∞—Å—ã–≤–∞–µ—Ç –µ–≥–æ HP –¥–æ 100 (–≤–æ—Å–∫—Ä–µ—à–µ–Ω–∏–µ). –¶–∏–∫–ª –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç—Å—è, –∏ —Å–ª–µ–¥—É—é—â–∞—è –ø—Ä–æ—Å—Ä–æ—á–µ–Ω–Ω–∞—è –∑–∞–¥–∞—á–∞ –Ω–∞–Ω–æ—Å–∏—Ç —É—Ä–æ–Ω —É–∂–µ –ø–æ "–Ω–æ–≤–æ–º—É" HP. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–æ–ª—É—á–∞–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ —Å–º–µ—Ä—Ç–∏, –∞ —Å–ª–µ–¥–æ–º ‚Äî —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ–± –æ–±—ã—á–Ω–æ–º —É—Ä–æ–Ω–µ, –æ—Å—Ç–∞–≤–∞—è—Å—å —Å –Ω–µ–ø–æ–ª–Ω—ã–º HP —Å—Ä–∞–∑—É –ø–æ—Å–ª–µ —Ä–µ—Å–µ—Ç–∞.

**–ü—Ä–∏—á–∏–Ω–∞:** –¶–∏–∫–ª –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∑–∞–¥–∞—á –Ω–µ –ø—Ä–µ—Ä—ã–≤–∞–µ—Ç—Å—è –∏ –Ω–µ –∏–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç –æ—Å—Ç–∞–≤—à–∏–µ—Å—è –∑–∞–¥–∞—á–∏ –ø–æ—Å–ª–µ —Å–º–µ—Ä—Ç–∏ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞. –ü–æ SPEC "All active tasks are deleted", –Ω–æ —Ç–∞–∫ –∫–∞–∫ —Ñ–∏–∑–∏—á–µ—Å–∫–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ –Ω–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ (—Å–º. ISSUE-009), –∑–∞–¥–∞—á–∏ –æ—Å—Ç–∞—é—Ç—Å—è –∏ –ø—Ä–æ–¥–æ–ª–∂–∞—é—Ç –Ω–∞–Ω–æ—Å–∏—Ç—å —É—Ä–æ–Ω.

**–†–µ—à–µ–Ω–∏–µ:** –í `check_deadlines` –¥–æ–±–∞–≤–ª–µ–Ω –∫–æ–Ω—Ç—Ä–æ–ª—å —Å–º–µ—Ä—Ç–∏ (`died`). –ï—Å–ª–∏ `apply_damage` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç `True`, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –≤ –º–Ω–æ–∂–µ—Å—Ç–≤–æ `dead_users`. –î–ª—è `dead_users` –ø–æ—Å–ª–µ–¥—É—é—â–∏–µ –∑–∞–¥–∞—á–∏ –≤ —Ü–∏–∫–ª–µ –ø—Ä–æ–ø—É—Å–∫–∞—é—Ç—Å—è. –¢–∞–∫–∂–µ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è `delete_all_active_tasks` (–∏–∑ `database/task_repo.py`), –∫–æ—Ç–æ—Ä–∞—è –ø–æ–º–µ—á–∞–µ—Ç –≤—Å–µ –∞–∫—Ç–∏–≤–Ω—ã–µ –∑–∞–¥–∞—á–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∫–∞–∫ `DELETED` (Soft Delete), –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞—è –¥–∞–ª—å–Ω–µ–π—à–∏–π —É—Ä–æ–Ω. –§–∞–π–ª—ã: `bot/logic/tasks.py`, `database/task_repo.py`.

---

## [ISSUE-009] –ù–µ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –∫–∞—Å–∫–∞–¥–Ω–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ –∑–∞–¥–∞—á –ø—Ä–∏ —Å–º–µ—Ä—Ç–∏

**–°—Ç–∞—Ç—É—Å:** –ó–∞–∫—Ä—ã—Ç–æ

**–û–ø–∏—Å–∞–Ω–∏–µ:** –í `docs/results/phase-3-result.md` —É–∫–∞–∑–∞–Ω–æ, —á—Ç–æ —É–¥–∞–ª–µ–Ω–∏–µ –∑–∞–¥–∞—á –ø—Ä–∏ —Å–º–µ—Ä—Ç–∏ "–ø—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ –∫–∞—Å–∫–∞–¥". –û–¥–Ω–∞–∫–æ —Ñ—É–Ω–∫—Ü–∏—è `reset_character` –≤ `bot/logic/game.py` –Ω–µ —É–¥–∞–ª—è–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –∞ –ª–∏—à—å –æ–±–Ω–æ–≤–ª—è–µ—Ç –µ–≥–æ –ø–æ–ª—è (Level, XP, HP). –ú–µ—Ö–∞–Ω–∏–∑–º `ON DELETE CASCADE` –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Ç–æ–ª—å–∫–æ –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ —Å—Ç—Ä–æ–∫–∏ —Ä–æ–¥–∏—Ç–µ–ª—è (User), —á–µ–≥–æ –Ω–µ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç. –í —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ –∑–∞–¥–∞—á–∏ –Ω–µ —É–¥–∞–ª—è—é—Ç—Å—è –∏ –æ—Å—Ç–∞—é—Ç—Å—è –∞–∫—Ç–∏–≤–Ω—ã–º–∏ (–∏ –ø—Ä–æ—Å—Ä–æ—á–µ–Ω–Ω—ã–º–∏), –Ω–∞—Ä—É—à–∞—è —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–µ SPEC "All active tasks are deleted".

**–ü—Ä–∏—á–∏–Ω–∞:** –ù–µ–≤–µ—Ä–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω–∞—è –ø—Ä–µ–¥–ø–æ—Å—ã–ª–∫–∞, —á—Ç–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ–ª–µ–π –æ–±—ä–µ–∫—Ç–∞ –≤—ã–∑–æ–≤–µ—Ç –∫–∞—Å–∫–∞–¥–Ω–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ —Å–≤—è–∑–∞–Ω–Ω—ã—Ö –∑–∞–ø–∏—Å–µ–π.

**–†–µ—à–µ–Ω–∏–µ:** –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è `delete_all_active_tasks` –≤ `database/task_repo.py`. –í—ã–∑–æ–≤ —ç—Ç–æ–π —Ñ—É–Ω–∫—Ü–∏–∏ –¥–æ–±–∞–≤–ª–µ–Ω –≤ `bot/logic/tasks.py` –≤–Ω—É—Ç—Ä–∏ –±–ª–æ–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å–º–µ—Ä—Ç–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è. –≠—Ç–æ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç —è–≤–Ω–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ (—Å—Ç–∞—Ç—É—Å DELETED) –≤—Å–µ—Ö –∞–∫—Ç–∏–≤–Ω—ã—Ö –∑–∞–¥–∞—á –ø—Ä–∏ –æ–±–Ω—É–ª–µ–Ω–∏–∏ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—è —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º SPEC. –§–∞–π–ª—ã: `bot/logic/tasks.py`, `database/task_repo.py`.

---

## [ISSUE-010] –î–µ–¥–ª–∞–π–Ω—ã —Å–æ–∑–¥–∞—é—Ç—Å—è —Å –æ—à–∏–±–∫–æ–π —á–∞—Å–æ–≤–æ–≥–æ –ø–æ—è—Å–∞ (—Å–¥–≤–∏–≥ +3 —á–∞—Å–∞)

**–°—Ç–∞—Ç—É—Å:** –ó–∞–∫—Ä—ã—Ç–æ

**–û–ø–∏—Å–∞–Ω–∏–µ:** –ü—Ä–∏ –≤–≤–æ–¥–µ –∞–±—Å–æ–ª—é—Ç–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, "17.02 00:34") –±–æ—Ç –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä–æ–≤–∞–ª –µ–≥–æ –∫–∞–∫ UTC, –≤ —Ç–æ –≤—Ä–µ–º—è –∫–∞–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –ø–æ–¥—Ä–∞–∑—É–º–µ–≤–∞—é—Ç –º–æ—Å–∫–æ–≤—Å–∫–æ–µ –≤—Ä–µ–º—è (UTC+3). –í —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ –¥–µ–¥–ª–∞–π–Ω —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–ª—Å—è –Ω–∞ 3 —á–∞—Å–∞ –ø–æ–∑–∂–µ –æ–∂–∏–¥–∞–µ–º–æ–≥–æ (00:34 UTC = 03:34 MSK). –≠—Ç–æ —Ç–∞–∫–∂–µ –≤–ª–∏—è–ª–æ –Ω–∞ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–µ –¥–∞—Ç—ã ("—Å–µ–≥–æ–¥–Ω—è", "–∑–∞–≤—Ç—Ä–∞"), –µ—Å–ª–∏ –ø–µ—Ä–µ—Ö–æ–¥ —Å—É—Ç–æ–∫ –≤ UTC –∏ MSK –Ω–µ —Å–æ–≤–ø–∞–¥–∞–ª.

**–ü—Ä–∏—á–∏–Ω–∞:** –§—É–Ω–∫—Ü–∏—è `parse_deadline` –Ω–µ —É—á–∏—Ç—ã–≤–∞–ª–∞ —á–∞—Å–æ–≤–æ–π –ø–æ—è—Å –∏ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∞ UTC –¥–ª—è –≤—Å–µ—Ö —Ä–∞—Å—á–µ—Ç–æ–≤.

**–†–µ—à–µ–Ω–∏–µ:** –í `bot/deadline_parser.py` —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –¥–µ—Ñ–æ–ª—Ç–Ω—ã–π —á–∞—Å–æ–≤–æ–π –ø–æ—è—Å –≤–≤–æ–¥–∞ `INPUT_TIMEZONE` (UTC+3). –í—Å—è –ª–æ–≥–∏–∫–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞ (`now`, –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–µ –¥–∞—Ç—ã, –∞–±—Å–æ–ª—é—Ç–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è) –ø–µ—Ä–µ–≤–µ–¥–µ–Ω–∞ –Ω–∞ —è–≤–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —ç—Ç–æ–≥–æ —á–∞—Å–æ–≤–æ–≥–æ –ø–æ—è—Å–∞ –ø–µ—Ä–µ–¥ –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–µ–π –≤ UTC –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è. –¢.–µ. –≤–≤–æ–¥ "00:34" —Ç–µ–ø–µ—Ä—å —Ç—Ä–∞–∫—Ç—É–µ—Ç—Å—è –∫–∞–∫ "00:34 MSK" -> "21:34 UTC (–ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ –¥–Ω—è)". –§–∞–π–ª: `bot/deadline_parser.py`.

---

## [ISSUE-011] –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –¥–µ–¥–ª–∞–π–Ω–∞ –≤ —Å–æ–æ–±—â–µ–Ω–∏–∏ –æ —Å–æ–∑–¥–∞–Ω–∏–∏ –∑–∞–¥–∞—á–∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç UTC –≤—Ä–µ–º—è

**–°—Ç–∞—Ç—É—Å:** –ó–∞–∫—Ä—ã—Ç–æ

**–û–ø–∏—Å–∞–Ω–∏–µ:** –ü–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–¥–∞—á–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –ø—Ä–∏—Ö–æ–¥–∏—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ "–ó–∞–¥–∞—á–∞ —Å–æ–∑–¥–∞–Ω–∞!". –í –ø–æ–ª–µ "–î–µ–¥–ª–∞–π–Ω" –æ—Ç–æ–±—Ä–∞–∂–∞–ª–æ—Å—å –≤—Ä–µ–º—è –≤ UTC, —Ö–æ—Ç—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ–∂–∏–¥–∞–µ—Ç —É–≤–∏–¥–µ—Ç—å –º–µ—Å—Ç–Ω–æ–µ –≤—Ä–µ–º—è (MSK). –ù–∞–ø—Ä–∏–º–µ—Ä, –ø—Ä–∏ –≤–≤–æ–¥–µ "22:10" (MSK) –∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–º —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ –≤ –ë–î (19:10 UTC), –≤ —Å–æ–æ–±—â–µ–Ω–∏–∏ –æ—Ç–æ–±—Ä–∞–∂–∞–ª–æ—Å—å "—Å–µ–≥–æ–¥–Ω—è, 19:10".

**–ü—Ä–∏—á–∏–Ω–∞:** –§—É–Ω–∫—Ü–∏—è `format_deadline_date` –≤ `bot/time_utils.py` —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–ª–∞ –ø–µ—Ä–µ–¥–∞–Ω–Ω—ã–π –æ–±—ä–µ–∫—Ç `datetime` (UTC) –Ω–∞–ø—Ä—è–º—É—é, –±–µ–∑ –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏ –≤ —á–∞—Å–æ–≤–æ–π –ø–æ—è—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

**–†–µ—à–µ–Ω–∏–µ:** –í `format_deadline_date` –¥–æ–±–∞–≤–ª–µ–Ω–∞ –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è `dt` –∏ `now` –≤ `INPUT_TIMEZONE` (UTC+3) –ø–µ—Ä–µ–¥ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º –∏ –ø—Ä–æ–≤–µ—Ä–∫–æ–π –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã—Ö –¥–∞—Ç ("—Å–µ–≥–æ–¥–Ω—è"/"–∑–∞–≤—Ç—Ä–∞"). –¢–µ–ø–µ—Ä—å –≤—Ä–µ–º—è –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–∑ MSK. –§–∞–π–ª: `bot/time_utils.py`.

---

## [ISSUE-012] –û—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç inline-–∫–Ω–æ–ø–∫–∏ –≤ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è—Ö –æ —Å–º–µ—Ä—Ç–∏ –∏ –ø—Ä–æ—Å—Ä–æ—á–∫–µ –∑–∞–¥–∞—á

**–°—Ç–∞—Ç—É—Å:** –ó–∞–∫—Ä—ã—Ç–æ

**–û–ø–∏—Å–∞–Ω–∏–µ:** –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è, –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º—ã–µ –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫–æ–º –ø—Ä–∏ –ø—Ä–æ—Å—Ä–æ—á–∫–µ –∑–∞–¥–∞—á –∏–ª–∏ —Å–º–µ—Ä—Ç–∏ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞, –ø—Ä–∏—Ö–æ–¥–∏–ª–∏ –≤ –≤–∏–¥–µ –æ–±—ã—á–Ω–æ–≥–æ —Ç–µ–∫—Å—Ç–∞ –±–µ–∑ —Ä–∞–±–æ—Ç–∞—é—â–∏—Ö inline-–∫–Ω–æ–ø–æ–∫. –í–º–µ—Å—Ç–æ —Ä–µ–∞–ª—å–Ω—ã—Ö –∫–Ω–æ–ø–æ–∫ –≤ —Ç–µ–∫—Å—Ç–µ –æ—Ç–æ–±—Ä–∞–∂–∞–ª–∏—Å—å –Ω–µ–∞–∫—Ç–∏–≤–Ω—ã–µ —Å–∫–æ–±–∫–∏ –≤–∏–¥–∞ `[üè† –ú–µ–Ω—é]`.

**–ü—Ä–∏—á–∏–Ω–∞:** –í `bot/logic/tasks.py` –ª–æ–≥–∏–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –≤ —Ü–∏–∫–ª–µ `check_deadlines` –Ω–µ –≤–∫–ª—é—á–∞–ª–∞ –ø–µ—Ä–µ–¥–∞—á—É `reply_markup`. –°–æ–æ–±—â–µ–Ω–∏—è —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–ª–∏—Å—å —Ç–æ–ª—å–∫–æ –∏–∑ —Ç–µ–∫—Å—Ç–∞, —Å–æ–¥–µ—Ä–∂–∞—â–µ–≥–æ –≤–∏–∑—É–∞–ª—å–Ω—ã–µ –∑–∞–≥–ª—É—à–∫–∏.

**–†–µ—à–µ–Ω–∏–µ:** (1) –í `bot/keyboards.py` –¥–æ–±–∞–≤–ª–µ–Ω—ã —Ñ—É–Ω–∫—Ü–∏–∏ `death_notification_keyboard` –∏ `overdue_notification_keyboard`. (2) –í `bot/logic/tasks.py` —Å–ø–∏—Å–æ–∫ `notifications` —Ä–∞—Å—à–∏—Ä–µ–Ω –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –∫–Ω–æ–ø–æ–∫, –∫–æ—Ç–æ—Ä—ã–µ —Ç–µ–ø–µ—Ä—å –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è –≤ `bot.send_message`. (3) –ò–∑ `bot/texts.py` —É–¥–∞–ª–µ–Ω—ã —Ç–µ–∫—Å—Ç–æ–≤—ã–µ –∑–∞–≥–ª—É—à–∫–∏ –∫–Ω–æ–ø–æ–∫. –¢–µ–ø–µ—Ä—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è —Å–æ–¥–µ—Ä–∂–∞—Ç –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω—ã–µ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–µ –∫–Ω–æ–ø–∫–∏. –§–∞–π–ª—ã: `bot/keyboards.py`, `bot/logic/tasks.py`, `bot/texts.py`.

---

## [ISSUE-013] –û—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç inline-–∫–Ω–æ–ø–∫–∏ –≤–æ –≤—Å–µ—Ö —Å–∏—Å—Ç–µ–º–Ω—ã—Ö —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è—Ö (Level Up, Reminders)

**–°—Ç–∞—Ç—É—Å:** –ó–∞–∫—Ä—ã—Ç–æ

**–û–ø–∏—Å–∞–Ω–∏–µ:** –ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è ISSUE-012 –±—ã–ª–æ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–æ, —á—Ç–æ –¥—Ä—É–≥–∏–µ —Ç–∏–ø—ã —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π (–ø–æ–≤—ã—à–µ–Ω–∏–µ —É—Ä–æ–≤–Ω—è, –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ –∑–∞ 1 —á–∞—Å, –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ –∑–∞–¥–∞—á–∏) —Ç–∞–∫–∂–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç —Ç–µ–∫—Å—Ç–æ–≤—ã–µ –∑–∞–≥–ª—É—à–∫–∏ `[–ö–Ω–æ–ø–∫–∞]` –≤–º–µ—Å—Ç–æ —Ä–µ–∞–ª—å–Ω—ã—Ö inline-–∫–Ω–æ–ø–æ–∫.

**–ü—Ä–∏—á–∏–Ω–∞:** –ü–æ–≤—Å–µ–º–µ—Å—Ç–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö —à–∞–±–ª–æ–Ω–æ–≤ –≤ `bot/texts.py` –∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ø–µ—Ä–µ–¥–∞—á–∏ `reply_markup` –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏—Ö –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞—Ö –∏ —Ñ–æ–Ω–æ–≤—ã—Ö –∑–∞–¥–∞—á–∞—Ö.

**–†–µ—à–µ–Ω–∏–µ:** (1) –í `bot/keyboards.py` –¥–æ–±–∞–≤–ª–µ–Ω–∞ `reminder_keyboard`. (2) –í `bot/logic/notifications.py` (–Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è) –¥–æ–±–∞–≤–ª–µ–Ω–∞ –æ—Ç–ø—Ä–∞–≤–∫–∞ –∫–Ω–æ–ø–æ–∫. (3) –í `bot/handlers/task_list.py` (Level Up –∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∑–∞–¥–∞—á–∏) –¥–æ–±–∞–≤–ª–µ–Ω–∞ –æ—Ç–ø—Ä–∞–≤–∫–∞ –∫–Ω–æ–ø–æ–∫ –º–µ–Ω—é –∏ —Å–ø–∏—Å–∫–∞ –∑–∞–¥–∞—á. (4) –í `bot/texts.py` —É–¥–∞–ª–µ–Ω—ã –ø–æ—Å–ª–µ–¥–Ω–∏–µ —Ç–µ–∫—Å—Ç–æ–≤—ã–µ –∑–∞–≥–ª—É—à–∫–∏ –∫–Ω–æ–ø–æ–∫. –§–∞–π–ª—ã: `bot/keyboards.py`, `bot/logic/notifications.py`, `bot/handlers/task_list.py`, `bot/texts.py`.

---

## [ISSUE-014] –ù–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–Ω–æ–ø–∫–∞ "–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞" –≤ –º–µ–Ω—é

**–°—Ç–∞—Ç—É—Å:** –ó–∞–∫—Ä—ã—Ç–æ

**–û–ø–∏—Å–∞–Ω–∏–µ:** –ü—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ –Ω–∞ –∫–Ω–æ–ø–∫—É `üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞` –≤ –≥–ª–∞–≤–Ω–æ–º –º–µ–Ω—é –Ω–∏—á–µ–≥–æ –Ω–µ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç.

**–ü—Ä–∏—á–∏–Ω–∞:** –í —Ñ–∞–π–ª–µ `bot/handlers/menu.py` –æ—Ç—Å—É—Ç—Å—Ç–≤–æ–≤–∞–ª –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ (`callback_query_handler`) –¥–ª—è –¥–∞–Ω–Ω—ã—Ö `screen:stats`.
**–†–µ—à–µ–Ω–∏–µ:** –í `bot/handlers/menu.py` –¥–æ–±–∞–≤–ª–µ–Ω –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π –º–µ—Ç–æ–¥ `callback_stats`, –∫–æ—Ç–æ—Ä—ã–π –∑–∞–≥—Ä—É–∂–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç —ç–∫—Ä–∞–Ω —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ (`statistics_screen_message`) —Å –∫–Ω–æ–ø–∫–æ–π –≤–æ–∑–≤—Ä–∞—Ç–∞ –≤ –º–µ–Ω—é. –§–∞–π–ª: `bot/handlers/menu.py`.

---

## [ISSUE-015] –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –Ω–µ—Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏

**–°—Ç–∞—Ç—É—Å:** –ó–∞–∫—Ä—ã—Ç–æ

**–û–ø–∏—Å–∞–Ω–∏–µ:** –í –ø—Ä–æ–µ–∫—Ç–µ —Å–æ—Å—É—â–µ—Å—Ç–≤–æ–≤–∞–ª–∏ –¥–≤–∞ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞ –¥–ª—è —ç–∫—Ä–∞–Ω–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏. –ö–ª–∞–≤–∏–∞—Ç—É—Ä–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∞ `screen:stats`, –∞ –æ–¥–∏–Ω –∏–∑ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ –æ–∂–∏–¥–∞–ª `statistics`.

**–ü—Ä–∏—á–∏–Ω–∞:** –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –≤ —Ä–∞–∑–Ω—ã—Ö –º–æ–¥—É–ª—è—Ö (`menu.py` –∏ `statistics.py`).

**–†–µ—à–µ–Ω–∏–µ:** (1) –£–¥–∞–ª–µ–Ω –¥—É–±–ª–∏—Ä—É—é—â–∏–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –∏–∑ `bot/handlers/menu.py`. (2) –í `bot/handlers/statistics.py` callback –∏–∑–º–µ–Ω–µ–Ω –Ω–∞ `screen:stats` –∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞ –∫–ª–∞–≤–∏–∞—Ç—É—Ä–∞ –≤–æ–∑–≤—Ä–∞—Ç–∞ –≤ –º–µ–Ω—é `back_to_menu_keyboard()`. –§–∞–π–ª—ã: `bot/handlers/menu.py`, `bot/handlers/statistics.py`.

---

## [ISSUE-016] –ù–µ—Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å timezone-aware –∏ naive datetime –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∑–∞–¥–∞—á–∏

**–°—Ç–∞—Ç—É—Å:** –ó–∞–∫—Ä—ã—Ç–æ

**–û–ø–∏—Å–∞–Ω–∏–µ:** –ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –Ω–æ–≤–æ–π –∑–∞–¥–∞—á–∏ –ø–æ—Å–ª–µ –≤–≤–æ–¥–∞ –Ω–∞–∑–≤–∞–Ω–∏—è –∏ –≤—ã–±–æ—Ä–∞ –¥–∞—Ç—ã/–≤—Ä–µ–º–µ–Ω–∏ –≤–æ–∑–Ω–∏–∫–∞–ª–∞ –æ—à–∏–±–∫–∞ `can't subtract offset-naive and offset-aware datetimes`. Inline-–∫–Ω–æ–ø–∫–∏ –≤—ã–±–æ—Ä–∞ –¥–∞—Ç—ã –∏ –≤—Ä–µ–º–µ–Ω–∏ –Ω–µ —Ä–∞–±–æ—Ç–∞–ª–∏. –û—à–∏–±–∫–∞ –ø—Ä–æ—è–≤–ª—è–ª–∞—Å—å –ø—Ä–∏ –ø–æ–ø—ã—Ç–∫–µ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –∑–∞–¥–∞—á—É –≤ –ë–î.

**–ü—Ä–∏—á–∏–Ω–∞:** –§—É–Ω–∫—Ü–∏—è `parse_deadline` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç timezone-aware datetime (—Å `tzinfo=ZoneInfo('UTC')`), –∞ –º–æ–¥–µ–ª—å `Task` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `TIMESTAMP WITHOUT TIME ZONE` —Å –¥–µ—Ñ–æ–ª—Ç–Ω—ã–º –∑–Ω–∞—á–µ–Ω–∏–µ–º `datetime.utcnow()` (naive datetime). –ü—Ä–∏ –≤—Å—Ç–∞–≤–∫–µ –≤ –ë–î asyncpg –Ω–µ –º–æ–∂–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å —Å–º–µ—à–∏–≤–∞–Ω–∏–µ aware –∏ naive datetime –≤ –æ–¥–Ω–æ–º –∑–∞–ø—Ä–æ—Å–µ.

**–†–µ—à–µ–Ω–∏–µ:** –í —Ñ—É–Ω–∫—Ü–∏–∏ `create_task` (database/task_repo.py) –¥–æ–±–∞–≤–ª–µ–Ω–æ —É–¥–∞–ª–µ–Ω–∏–µ tzinfo –∏–∑ deadline –ø–µ—Ä–µ–¥ —Å–æ–∑–¥–∞–Ω–∏–µ–º –æ–±—ä–µ–∫—Ç–∞ Task: `if deadline.tzinfo is not None: deadline = deadline.replace(tzinfo=None)`. –§–∞–π–ª: `database/task_repo.py`.

---

## [ISSUE-017] –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç relationship Task.user –¥–ª—è selectinload

**–°—Ç–∞—Ç—É—Å:** –ó–∞–∫—Ä—ã—Ç–æ

**–û–ø–∏—Å–∞–Ω–∏–µ:** –ü—Ä–∏ –ø—Ä–æ–≤–µ—Ä–∫–µ –¥–µ–¥–ª–∞–π–Ω–æ–≤ –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –ø–∞–¥–∞–ª —Å –æ—à–∏–±–∫–æ–π `AttributeError: type object 'Task' has no attribute 'user'`. –§—É–Ω–∫—Ü–∏–∏ `get_overdue_tasks` –∏ `get_tasks_for_reminder` –∏—Å–ø–æ–ª—å–∑—É—é—Ç `selectinload(Task.user)`, –Ω–æ relationship –Ω–µ –±—ã–ª –æ–ø—Ä–µ–¥–µ–ª—ë–Ω –≤ –º–æ–¥–µ–ª–∏.

**–ü—Ä–∏—á–∏–Ω–∞:** –í –º–æ–¥–µ–ª–∏ `Task` –æ—Ç—Å—É—Ç—Å—Ç–≤–æ–≤–∞–ª–æ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ relationship –∫ –º–æ–¥–µ–ª–∏ `User`, —Ö–æ—Ç—è –∫–æ–¥ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª `selectinload(Task.user)` –¥–ª—è –∂–∞–¥–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–∏ —Å–≤—è–∑–∞–Ω–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

**–†–µ—à–µ–Ω–∏–µ:** –í –º–æ–¥–µ–ª—å `Task` –¥–æ–±–∞–≤–ª–µ–Ω relationship: `user = relationship("User", backref="tasks")`. –¢–∞–∫–∂–µ –¥–æ–±–∞–≤–ª–µ–Ω –∏–º–ø–æ—Ä—Ç `relationship` –∏–∑ `sqlalchemy.orm`. –§–∞–π–ª: `database/models.py`.

---

## [ISSUE-018] –°—Ä–∞–≤–Ω–µ–Ω–∏–µ naive –∏ aware datetime –≤ format_remaining_short

**–°—Ç–∞—Ç—É—Å:** –ó–∞–∫—Ä—ã—Ç–æ

**–û–ø–∏—Å–∞–Ω–∏–µ:** –ü—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ –Ω–∞ –∫–Ω–æ–ø–∫—É "–ú–æ–∏ –∑–∞–¥–∞—á–∏" –≤–æ–∑–Ω–∏–∫–∞–ª–∞ –æ—à–∏–±–∫–∞ `TypeError: can't compare offset-naive and offset-aware datetimes`. –§—É–Ω–∫—Ü–∏—è `format_remaining_short` –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∞ `get_now_utc()` (timezone-aware), –∞ `deadline` –∏–∑ –ë–î ‚Äî naive datetime.

**–ü—Ä–∏—á–∏–Ω–∞:** –í `bot/time_utils.py` —Ñ—É–Ω–∫—Ü–∏–∏ `format_remaining` –∏ `format_remaining_short` –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏ `get_now_utc()`, –≤–æ–∑–≤—Ä–∞—â–∞—é—â—É—é timezone-aware datetime, –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è —Å `deadline` –∏–∑ –ë–î, –∫–æ—Ç–æ—Ä—ã–π —Ö—Ä–∞–Ω–∏—Ç—Å—è –∫–∞–∫ naive UTC datetime.

**–†–µ—à–µ–Ω–∏–µ:** –í —Ñ—É–Ω–∫—Ü–∏—è—Ö `format_remaining` –∏ `format_remaining_short` –∑–∞–º–µ–Ω–µ–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `get_now_utc()` –Ω–∞ `datetime.utcnow()` –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–≥–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è —Å naive datetime –∏–∑ –ë–î. –¢–∞–∫–∂–µ –≤ `format_deadline_date` –¥–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ –∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ tzinfo –∫ naive datetime –ø–µ—Ä–µ–¥ –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–µ–π –≤ –ª–æ–∫–∞–ª—å–Ω—ã–π —á–∞—Å–æ–≤–æ–π –ø–æ—è—Å. –§–∞–π–ª: `bot/time_utils.py`.
